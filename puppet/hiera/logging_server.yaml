---
# -----------------
# logstash stuff
# run on LOGGING SERVER to collect logs from all the NODES
# -----------------
logstash::manage_repo: true
logstash::repo_version: '1.4'
logstash::java_install: true
# logstash::install_contrib: true
# logstash::contrib_version: '1.4'

logstash_config_lumberjacks:
  input-lumberjack:
    template:         "site/logstash/uber-input-logstashforwarder.erb"
    order:            10
    ssl_key:          '/etc/ssl/certs/selfsignedHOST.key'
    ssl_certificate:  '/etc/ssl/certs/selfsignedHOST.crt'

logstash_configs:
  filter-main:
    template: "site/logstash/uber-filters.erb"
    order: 20
  outputs:
    template: "site/logstash/uber-outputs.erb"
    order: 30

logstash_patternfiles:
  custom-patterns:
    source: "puppet:///modules/site/logstash/patterns/uber-patterns"

# -----------------
# Elastisearch stuff
# run on LOGGING SERVER to be a database for logs from all the NODES
# -----------------

elasticsearch::manage_repo: true
elasticsearch::repo_version: '1.3'

elastisearch_instances:
  main:
    ensure: 'present'


# -----------
# kibana (searchable log web interface)
# -----------

# install apache and use it to allow access to kibana files
kibana3::manage_ws: true
kibana3::ws_port: "5601"